#!/usr/bin/env bash
# ---
# Add your own commands, functions, and variables here.  Define defaults first,
# then `dk use:` the desired devkit modules, and then define any overrides to
# the devkit defaults.
# ---

# Available modules (uncomment to use):

dk use: reflex-watch        # watch multiple patterns and run different commands on them

# dk use: cram              # run tests using the "cram" functional test tool
# dk use: shell-console     # make the "console" command enter a subshell
# dk use: virtualenv        # enable creation and use of Python virtualenvs
# dk use: composer          # utilities for accessing composer-based dev tools
# dk use: peridot           # run tests using peridot-php
# dk use: psysh-console     # make the "console" command run the Psysh PHP REPL
# dk use: bash32            # enable doing tests/console/etc. in bash3.2 w/docker

# Define overrides, new commands, functions, etc. here:

dk use: mantle

# Don't watch scripts, the DB, or editor temp files
unwatch 'bin/**' 'script/**' 'deploy/db/**' '**/.~*.md'

# Changes to state files should re-run apply
watch+ 'imposer-project.md' '**/*.state.md' -- imposer apply

# Changes to content should be synced immediately, w/full sync at watch start
before "watch" wp postmark tree content
watch 'content/**/*.md' -- wp postmark sync {}

# Recreate dev container on changes to .envrc, deploy/dev.env, deploy/all.env, etc.
watch 'deploy/*.env' '.env' '.envrc' -- doco dev up -d

# TODO: re-build and re-up on changes to Mantle.doco.md
